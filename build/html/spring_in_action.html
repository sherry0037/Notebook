


<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Spring in Action - Notes &#8212; Notebook  documentation</title>
    <link rel="stylesheet" href="_static/yeen.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="index.html">Notebook  documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Spring in Action - Notes</a><ul>
<li><a class="reference internal" href="#basic-concepts">Basic concepts</a></li>
<li><a class="reference internal" href="#wiring-beans">Wiring beans</a><ul>
<li><a class="reference internal" href="#why-do-we-need-bean-wiring">Why do we need bean-wiring?</a></li>
<li><a class="reference internal" href="#spring-s-configuration-options">Spring’s configuration options</a></li>
<li><a class="reference internal" href="#automatically-wiring-beans">Automatically wiring beans</a><ul>
<li><a class="reference internal" href="#creating-beans">Creating beans</a></li>
<li><a class="reference internal" href="#setting-a-base-package-for-component-scanning">Setting a base package for component scanning</a></li>
<li><a class="reference internal" href="#annotating-beans-to-be-automatically-wired">Annotating beans to be automatically wired</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/spring_in_action.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="spring-in-action-notes">
<h1><a class="toc-backref" href="#id1">Spring in Action - Notes</a><a class="headerlink" href="#spring-in-action-notes" title="Permalink to this headline">¶</a></h1>
<p>Reading notes of the book <em>Spring in Action - 4th edition by Craig Walls</em>.</p>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#spring-in-action-notes" id="id1">Spring in Action - Notes</a></p>
<ul>
<li><p><a class="reference internal" href="#basic-concepts" id="id2">Basic concepts</a></p></li>
<li><p><a class="reference internal" href="#wiring-beans" id="id3">Wiring beans</a></p>
<ul>
<li><p><a class="reference internal" href="#why-do-we-need-bean-wiring" id="id4">Why do we need bean-wiring?</a></p></li>
<li><p><a class="reference internal" href="#spring-s-configuration-options" id="id5">Spring’s configuration options</a></p></li>
<li><p><a class="reference internal" href="#automatically-wiring-beans" id="id6">Automatically wiring beans</a></p>
<ul>
<li><p><a class="reference internal" href="#creating-beans" id="id7">Creating beans</a></p></li>
<li><p><a class="reference internal" href="#setting-a-base-package-for-component-scanning" id="id8">Setting a base package for component scanning</a></p></li>
<li><p><a class="reference internal" href="#annotating-beans-to-be-automatically-wired" id="id9">Annotating beans to be automatically wired</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="basic-concepts">
<h2><a class="toc-backref" href="#id2">Basic concepts</a><a class="headerlink" href="#basic-concepts" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="wiring-beans">
<h2><a class="toc-backref" href="#id3">Wiring beans</a><a class="headerlink" href="#wiring-beans" title="Permalink to this headline">¶</a></h2>
<div class="section" id="why-do-we-need-bean-wiring">
<h3><a class="toc-backref" href="#id4">Why do we need bean-wiring?</a><a class="headerlink" href="#why-do-we-need-bean-wiring" title="Permalink to this headline">¶</a></h3>
<p>An application (at least a non-trivial one) is made up of several objects, each has its own funtionalities. These objects must be aware of one another and communicate with one another to get their jobs done.</p>
<p>These associations between objects are created via constuction or lookup in the traditional way, leading to complicated code that’s difficult to reuse or unit-test. The ojects do more work the they should (like initializing other objects) and are highly coupled to one another.</p>
<p>This is when <strong>wiring</strong>, or <strong>dependency injection</strong> (DI), comes handy. Remeber, beans can be seen as just Plain Old Java Objects (POJOs) and the ojects are created and wired by <em>Spring application context</em> (container). Wiring means that, instead of letting the object to initialize it’s own instance of other objects, we will inject the instance into this object either using the <em>constructor</em> or a <em>setter</em>. In spring, the container will do this for you.</p>
<p>There are several ways to wire beans in Java. The three major ones are: autowiring, JavaConfig and XML.</p>
</div>
<div class="section" id="spring-s-configuration-options">
<h3><a class="toc-backref" href="#id5">Spring’s configuration options</a><a class="headerlink" href="#spring-s-configuration-options" title="Permalink to this headline">¶</a></h3>
<p>We need to tell Spring which beans to create and how to wire them together. There are three major approaches to write a bean wiring specification:</p>
<ul class="simple">
<li><p>Explicit configuration in XML</p></li>
<li><p>Explicit configuration in Java</p></li>
<li><p>Implicit bean discovery and automatic wiring</p></li>
</ul>
<p>The author recommends to use automatic wiring as much as possible. But you can use whichever you want, even mix them.</p>
</div>
<div class="section" id="automatically-wiring-beans">
<h3><a class="toc-backref" href="#id6">Automatically wiring beans</a><a class="headerlink" href="#automatically-wiring-beans" title="Permalink to this headline">¶</a></h3>
<p>Spring attacks automatic wiring from two angles:</p>
<ul class="simple">
<li><p><em>Component scanning</em>: Spring automatically discovers beans to be created in the application context.</p></li>
<li><p><em>Autowiring</em>: Spring automatically satisfies bean dependencies.</p></li>
</ul>
<div class="topic">
<p class="topic-title first">A Stereo System</p>
<p>To demonstrate Spring’s autowiring mechanism, we will create a stereo system. To start, we will create a <code class="docutils literal notranslate"><span class="pre">CompactDisc</span></code> class, and let Spring to discover and create it as a bean. Then we will have a <code class="docutils literal notranslate"><span class="pre">CDPlayer</span></code> class, also have Spring to discover it, and inject a CD bean into it.</p>
</div>
<div class="section" id="creating-beans">
<h4><a class="toc-backref" href="#id7">Creating beans</a><a class="headerlink" href="#creating-beans" title="Permalink to this headline">¶</a></h4>
<p>First, let’s write an interface for <code class="docutils literal notranslate"><span class="pre">CompactDisc</span></code>. Using interface keeps the coupling between any CD player implementation and the CD itself to a minimum.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">CompactDisc</span><span class="o">{</span>
    <span class="kt">void</span> <span class="nf">play</span><span class="o">();</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Now we write a specific implementation, <code class="docutils literal notranslate"><span class="pre">SgtPeppers</span></code>, of <code class="docutils literal notranslate"><span class="pre">CompactDisc</span></code>.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SgtPeppers</span> <span class="kd">implements</span> <span class="n">CompactDisc</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="n">String</span> <span class="n">title</span> <span class="o">=</span> <span class="s">&quot;Sgt. Pepper&#39;s Lonely Hearts Club Band&quot;</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">artist</span> <span class="o">=</span> <span class="s">&quot;The Beatles&quot;</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">play</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Playing &quot;</span> <span class="o">+</span> <span class="n">title</span> <span class="o">+</span> <span class="s">&quot; by &quot;</span> <span class="o">+</span> <span class="n">artist</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="topic">
<p class="topic-title first">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">SgtPeppers</span></code> class is annotated with <em>&#64;Component</em>. This identifies this class as a component class and tells Spring that a bean should be created for it. We don’t need to explicitly configure a <code class="docutils literal notranslate"><span class="pre">SgtPeppers</span></code> bean.</p>
</div>
<p>Spring needs to seek out classes annotated with &#64;Component and create beans from them. We write a configuration to tell it to do so.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Configuration</span>
<span class="nd">@ComponentScan</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CDPlayerConfig</span> <span class="o">{</span>
<span class="o">}</span>
</pre></div>
</div>
<p>In this minimal configuration, <code class="docutils literal notranslate"><span class="pre">&#64;ComponentScan</span></code> default to scanning the same package as the configuration class. We put the <code class="docutils literal notranslate"><span class="pre">CompactDisc</span></code> class under the same package as <code class="docutils literal notranslate"><span class="pre">CDPlayerConfig</span></code>, so that <code class="docutils literal notranslate"><span class="pre">&#64;ComponentScan</span></code> will find it and create a bean for it.</p>
<p>Now we can write a simple JUnit test that creates a Spring application context and asserts that the <code class="docutils literal notranslate"><span class="pre">CompactDisc</span></code> bean is created.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@RunWith</span><span class="o">(</span><span class="n">StringJUnit4ClassRunner</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="nd">@ContextConfiguration</span><span class="o">(</span><span class="n">classes</span><span class="o">=</span><span class="n">CDPlayerConfig</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CDPlayerTest</span><span class="o">{</span>

    <span class="nd">@Autowired</span>
    <span class="kd">private</span> <span class="n">CompactDisc</span> <span class="n">cd</span><span class="o">;</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">cdShouldNotBeNull</span><span class="o">(){</span>
        <span class="n">assertNotNull</span><span class="o">(</span><span class="n">cd</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Note:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">SpringJUnit4ClassRunner</span></code> automatically creates a Spring application context when the test starts.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&#64;ContextConfiguration</span></code> tells it to load configuration from <code class="docutils literal notranslate"><span class="pre">CDPlayerConfig</span></code> class.</p>
<blockquote>
<div><ul class="simple">
<li><p>The configuration class includes <code class="docutils literal notranslate"><span class="pre">&#64;ComponentScan</span></code>, so the application context will include the <code class="docutils literal notranslate"><span class="pre">CompactDisc</span></code> bean.</p></li>
</ul>
</div></blockquote>
</li>
<li><p>The test has a property of type <code class="docutils literal notranslate"><span class="pre">CompactDisc</span></code>, annotated with <code class="docutils literal notranslate"><span class="pre">&#64;Autowired</span></code>, to inject the bean into the test.</p></li>
<li><p>All classes in or under the <code class="docutils literal notranslate"><span class="pre">soundsystem</span></code> package that are annotated with <code class="docutils literal notranslate"><span class="pre">&#64;Component</span></code> will be created as beans.</p></li>
</ul>
</div>
<div class="section" id="setting-a-base-package-for-component-scanning">
<h4><a class="toc-backref" href="#id8">Setting a base package for component scanning</a><a class="headerlink" href="#setting-a-base-package-for-component-scanning" title="Permalink to this headline">¶</a></h4>
<p>When using <code class="docutils literal notranslate"><span class="pre">&#64;ComponentScan</span></code> with no attributes, it will default to the configuration class’s package as its base package.
We want to explictitly set the base package, so that we can keep all of the configuration code in a package of its own.
There are several ways to do it:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ComponentScan</span><span class="o">(</span><span class="s">&quot;soundsystem&quot;</span><span class="o">)</span>
</pre></div>
</div>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ComponentScan</span><span class="o">(</span><span class="n">basePackages</span><span class="o">=</span><span class="s">&quot;soundsystem&quot;</span><span class="o">)</span>
</pre></div>
</div>
<p>To dpecify multiple base packages:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ComponentScan</span><span class="o">(</span><span class="n">basePackages</span><span class="o">={</span><span class="s">&quot;soundsystem&quot;</span><span class="o">,</span> <span class="s">&quot;video&quot;</span><span class="o">})</span>
</pre></div>
</div>
<p>Or you can use classes/interfaces instead of strings:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@ComponentScan</span><span class="o">(</span><span class="n">basePackageClasses</span><span class="o">={</span><span class="n">CDPlayer</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">DVDPlayer</span><span class="o">.</span><span class="na">class</span><span class="o">})</span>
</pre></div>
</div>
</div>
<div class="section" id="annotating-beans-to-be-automatically-wired">
<h4><a class="toc-backref" href="#id9">Annotating beans to be automatically wired</a><a class="headerlink" href="#annotating-beans-to-be-automatically-wired" title="Permalink to this headline">¶</a></h4>
<p>Autowiring is a means of letting Spring automatically satisfy a bean’s dependencies by finding other beans in the application context that are a match to the bean’s needs. <code class="docutils literal notranslate"><span class="pre">&#64;Autowired</span></code> annotation is used for this case.</p>
<p>Consider a <code class="docutils literal notranslate"><span class="pre">CDPlayer</span></code> class:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Component</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">CDPlayer</span> <span class="kd">implements</span> <span class="n">MediaPlayer</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="n">CompactDisc</span> <span class="n">cd</span><span class="o">;</span>

    <span class="nd">@Autowired</span>
    <span class="kd">public</span> <span class="nf">CDPlayer</span><span class="o">(</span><span class="n">CompactDisc</span> <span class="n">cd</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">cd</span> <span class="o">=</span> <span class="n">cd</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">play</span><span class="o">(){</span>
        <span class="n">cd</span><span class="o">.</span><span class="na">play</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>The constructor of the <code class="docutils literal notranslate"><span class="pre">CDPlayer</span></code> class is annotated with <code class="docutils literal notranslate"><span class="pre">&#64;Autowired</span></code>. When Spring initialize the <code class="docutils literal notranslate"><span class="pre">CDPlayer</span></code> bean via the constructor, it passes a <code class="docutils literal notranslate"><span class="pre">CompactDisc</span></code> bean into it.</p>
<p>Another way to use <code class="docutils literal notranslate"><span class="pre">&#64;Autowired</span></code> is on a property’s setter method.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Autowired</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">setCompactDisc</span><span class="o">(</span><span class="n">CompactDisc</span> <span class="n">cd</span><span class="o">){</span>
    <span class="k">this</span><span class="o">.</span><span class="na">cd</span> <span class="o">=</span> <span class="n">cd</span><span class="o">;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>After Spring has instantiated the bean, it will try to satisfy the dependencies expressed through the setter methods. <code class="docutils literal notranslate"><span class="pre">&#64;Autowired</span></code> can also be applied to any method.</p>
<p>If there are no matching beans for the annotated constructor/method, Spring will throw an exception as the application context is being created. You can set the <code class="docutils literal notranslate"><span class="pre">required</span></code> attribute to <code class="docutils literal notranslate"><span class="pre">false</span></code> to avoid such exception.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Autowired</span><span class="o">(</span><span class="n">required</span><span class="o">=</span><span class="kc">false</span><span class="o">)</span>
</pre></div>
</div>
<p>This will leave the bean unwired if there are no matching beans. Remember, this can lead to <code class="docutils literal notranslate"><span class="pre">NullPointerExceptions</span></code>.</p>
<p>If therea re multiple matching beans, Spring will throw an exception indicating ambiguity. Chapter 3 will contain more information about ambiguity handling.</p>
<p>You can use <code class="docutils literal notranslate"><span class="pre">&#64;Inject</span></code> instead of <code class="docutils literal notranslate"><span class="pre">&#64;Autowired</span></code>. They are interchangeable in many cases.</p>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="index.html">Notebook  documentation</a> &#187;</li> 
      </ul>
    </div>
    
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Yixuan Ni.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.0.1.
    </div>
    

  </body>
</html>